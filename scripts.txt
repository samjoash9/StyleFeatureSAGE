conda activate /home/VM04/conda_envs/featureSage
source /home/VM04/conda_envs/featureSage/bin/deactivate


python tools/get_class_embedding.py \
--fse_checkpoint_path=pretrained_models/vgg_final_inverter.pt \
--train_data_path=../datasets/data_root/train \
--class_embedding_path=class_embeddings/vgg_face \
--test_batch_size=32 \
--test_workers=16


python tools/train.py \
--dataset_type=vgg_encode  \
--exp_dir=experiment/vgg_face_07 \
--workers=4 \
--batch_size=4 \
--valid_batch_size=4 \
--valid_workers=4 \
--val_interval=2500 \
--save_interval=5000 \
--start_from_latent_avg \
--learn_in_w \
--l2_lambda=1.0 \
--sparse_lambda=0.005 \
--orthogonal_lambda=0.0005 \
--A_length=100 \
--fse_checkpoint_path=pretrained_models/vgg_face_editor.pt \
--fse_inverter_path=pretrained_models/vgg_final_inverter.pt \
--use_fse_full \
--use_fse_encoder \
--train_feature_editor \
--apply_feature_editing \
--feature_scale=1.0 \
--feature_scale_schedule \
--feature_scale_warmup=10000 \
--freeze_fse_encoder \
--class_embedding_path=class_embeddings/vgg_face/class_embeddings.pt \
--image_interval=100 \
--board_interval=50 \
--max_steps=15000


python tools/generate.py \
    --fse_checkpoint_path=pretrained_models/vgg_face_editor.pt \
    --test_data_path=../datasets/data_root/test \
    --output_path=outputs/vgg_faces \
    --class_embedding_path=class_embeddings/vgg_face/class_embeddings.pt \
    --n_distribution_path=n_distribution/vgg_faces \
    --apply_feature_editing \
    --feature_scale 0.8



python tools/generate.py \
    --fse_checkpoint_path=pretrained_models/vgg_final_inverter.pt \
    --test_data_path=../datasets/data_root/test \
    --output_path=outputs/vgg_faces_feature_edit \
    --class_embedding_path=class_embeddings/vgg_face/class_embeddings.pt \
    --n_distribution_path=n_distribution/vgg_faces \
    --apply_feature_editing \
    --feature_scale=0.8 \
    --n_images=20


python tools/generate.py \
    --fse_checkpoint_path=pretrained_models/vgg_final_inverter.pt \
    --train_data_path=../datasets/data_root/train \
    --n_distribution_path=n_distribution/vgg_faces \
    --generate_n_distribution